# CI Profile - Stabile Konfiguration f端r GitHub Actions
# Nutzt GitHub Services PostgreSQL, keine Testcontainers

# Datasource - fest konfiguriert f端r CI
quarkus.datasource.devservices.enabled=false
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/freshplan
quarkus.datasource.username=freshplan
quarkus.datasource.password=freshplan

# Flyway - Clean database for each CI run to ensure consistent state
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
# IMPORTANT: Clean database in CI to avoid test pollution between runs
quarkus.flyway.clean-at-start=true
quarkus.flyway.out-of-order=true
quarkus.flyway.repair-at-start=false
quarkus.flyway.locations=classpath:db/migration,classpath:db/testdata

# Hibernate - nur validieren, keine Schema-Generierung
quarkus.hibernate-orm.database.generation=validate

# Security - komplett deaktiviert f端r Tests
quarkus.oidc.enabled=false
quarkus.oidc.tenant-enabled=false
quarkus.http.auth.proactive=false
quarkus.security.jaxrs.deny-unannotated-endpoints=false
quarkus.http.auth.permission.permit-all.paths=/*
quarkus.http.auth.permission.permit-all.policy=permit

# Logging - schlank f端r CI
quarkus.log.level=INFO
quarkus.log.category."io.quarkus".level=INFO
quarkus.log.category."org.hibernate".level=WARN
quarkus.log.category."org.testcontainers".level=ERROR

# Test-Timeouts
quarkus.test.timeout=300s

# CQRS Feature Flags - Conservative defaults
features.cqrs.enabled=false
features.cqrs.customers.list.enabled=false
features.cqrs.customers.search.enabled=false
features.cqrs.opportunities.enabled=false
features.cqrs.salesCockpit.enabled=false
features.cqrs.shadow.enabled=false
features.cqrs.shadow.sampling=0.0