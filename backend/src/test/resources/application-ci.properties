# CI Profile - Stabile Konfiguration für GitHub Actions
# Nutzt GitHub Services PostgreSQL, keine Testcontainers

# Datasource - fest konfiguriert für CI
quarkus.datasource.devservices.enabled=false
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/freshplan
quarkus.datasource.username=freshplan
quarkus.datasource.password=freshplan

# Flyway - Migration an, aber kein Drop&Create
quarkus.flyway.migrate-at-start=true
quarkus.flyway.baseline-on-migrate=true
# IMPORTANT: Schema wird im GitHub Actions Workflow zurückgesetzt
quarkus.flyway.clean-at-start=false
quarkus.flyway.out-of-order=true
quarkus.flyway.repair-at-start=false
# CI-spezifische Migrationen zusätzlich laden
quarkus.flyway.locations=classpath:db/migration,classpath:db/testdata,classpath:db/ci-migrations

# Hibernate - nur validieren, keine Schema-Generierung
quarkus.hibernate-orm.database.generation=none
# Zeitzone fix, damit Partitionen deterministisch matchen
quarkus.hibernate-orm.jdbc.timezone=UTC

# Security - komplett deaktiviert für Tests
quarkus.oidc.enabled=false
quarkus.oidc.tenant-enabled=false
quarkus.http.auth.proactive=false
quarkus.security.jaxrs.deny-unannotated-endpoints=false
quarkus.http.auth.permission.permit-all.paths=/*
quarkus.http.auth.permission.permit-all.policy=permit

# Logging - schlank für CI
quarkus.log.level=INFO
quarkus.log.category."io.quarkus".level=INFO
quarkus.log.category."org.hibernate".level=WARN
quarkus.log.category."org.testcontainers".level=ERROR

# Test-Timeouts
quarkus.test.timeout=300s

# CQRS Feature Flags - Conservative defaults
features.cqrs.enabled=false
features.cqrs.customers.list.enabled=false
features.cqrs.customers.search.enabled=false
features.cqrs.opportunities.enabled=false
features.cqrs.salesCockpit.enabled=false
features.cqrs.shadow.enabled=false
features.cqrs.shadow.sampling=0.0